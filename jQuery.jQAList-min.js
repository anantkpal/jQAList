/*!
 * jQuery.jQAList
 * Author: Anant Pal -  anantkpal@yahoo.co.in
 * Copyright (c) 2013 Anant Pal(anantkpal@yahoo.co.in).  All rights reserved.
 * The copyrights embodied in the content of this file are licensed
 * by Anant Pal(anantkpal@yahoo.co.in) under the BSD  open source license.
 */
(function(a){a.fn.jQAList=function(b){b.paginationOptions=a.extend({enabled:false,pageLength:5,showMaxPageNumbers:5,showFirst:true,showLast:true,showPrev:true,showNext:true,container:"#alist-pagination"},b.paginationOptions);b=a.extend({searchbox:"#alist-searchbox",container:"#alist-container",repeater:".alist-item",valueselectors:null,defaultListDisplay:true,sortOptions:null,paginationOptions:null},b);if(b.valueselectors===null){throw"valueselectors cannot be null"}var d=function(e,k,l,h){var g=this;var j="jQAList-found";var f="asc";this.pagination={enabled:h.enabled,pageLength:h.pageLength,showMaxPageNumbers:h.showMaxPageNumbers,showFirst:h.showFirst,showLast:h.showLast,showPrev:h.showPrev,showNext:h.showNext,currentActivePage:1,container:h.container,totalPages:Math.ceil(a(e+" > "+k+"["+j+"=true]").size()/h.pageLength),update:function(){if(!g.pagination.enabled){return}g.pagination.totalPages=Math.ceil(a(e+" > "+k+"["+j+"=true]").size()/g.pagination.pageLength);a(a(g.pagination.container).find("ul[jqalist-plist]")).remove();if(g.pagination.totalPages<=0){return}var n=a(g.pagination.container).append('<ul jqalist-plist="ul"></ul>');n=(a(g.pagination.container).find("ul[jqalist-plist]"));a(n).append('<li jqalist-plist="prev">Prev</li>');a(n).append('<li jqalist-plist="first">First</li>');a(n).append('<li jqalist-plist="last">Last</li>');a(n).append('<li jqalist-plist="next">Next</li>');a(n).find("li[jqalist-plist=first]").after('<li jqalist-plist="'+g.pagination.currentActivePage+'" jqalist-plist-active="true">'+g.pagination.currentActivePage+"</li>");var p=0;var o=0;var q=true;while(p+o+1<g.pagination.showMaxPageNumbers&&p+o+1<g.pagination.totalPages){if(q){q=false;if(g.pagination.currentActivePage-p-1>=1){a(n).find("li[jqalist-plist=first]").after('<li jqalist-plist="'+(g.pagination.currentActivePage-p-1)+'">'+(g.pagination.currentActivePage-p-1)+"</li>");p++}}else{q=true;if(g.pagination.currentActivePage+o+1<=g.pagination.totalPages){a(n).find("li[jqalist-plist=last]").before('<li jqalist-plist="'+(g.pagination.currentActivePage+o+1)+'">'+(g.pagination.currentActivePage+o+1)+"</li>");o++}}}if(a(n).find("li[jqalist-plist=first]").next().attr("jqalist-plist")!="1"){a(n).find("li[jqalist-plist=first]").after("<li>..</li>")}if(a(n).find("li[jqalist-plist=last]").prev().attr("jqalist-plist")!=""+g.pagination.totalPages+""){a(n).find("li[jqalist-plist=last]").before("<li>..</li>")}a(e+" > "+k+"["+j+"=true]").hide();var m=a(e+" > "+k+"["+j+"=true]");for(i=((g.pagination.currentActivePage-1)*g.pagination.pageLength);(i<m.length&&i<((g.pagination.currentActivePage)*g.pagination.pageLength));i++){a(m[i]).show()}a(a(g.pagination.container).find("li[jqalist-plist]")).on("click",g.pagination.setcurrentpage)},setcurrentpage:function(){var m=a(this).attr("jqalist-plist");if(m=="first"){g.pagination.currentActivePage=1}else{if(m=="last"){g.pagination.currentActivePage=g.pagination.totalPages}else{if(m=="next"){g.pagination.currentActivePage=g.pagination.currentActivePage+1<=g.pagination.totalPages?g.pagination.currentActivePage+1:g.pagination.totalPages}else{if(m=="prev"){g.pagination.currentActivePage=g.pagination.currentActivePage-1>=1?g.pagination.currentActivePage-1:1}else{g.pagination.currentActivePage=parseInt(m)}}}}g.pagination.update()}};this.showAList=function(){a(e+" > "+k).show();g.pagination.update()};this.hideAList=function(){a(e+" > "+k).hide();g.pagination.update()};this.clearAListSearchResults=function(){a(e+" > "+k+"["+j+"=true]").removeAttr(j)};this.searchAList=function(m){g.clearAListSearchResults();a(e+" > "+k).each(function(){a(this).find(l.toString()).each(function(){if(a(this).text().toLowerCase().search(m)>-1){a(this).parents(k).attr(j,"true");return}})});g.updateAList(e+" > "+k)};this.sortAList=function(n,m){a(e+" > "+k).sort(function(p,o){return m==="asc"?a(a(p).find(n)).text()>a(a(o).find(n)).text():a(a(p).find(n)).text()<a(a(o).find(n)).text()}).appendTo(e)};this.updateAList=function(m){g.hideAList();a(m+"["+j+"=true]").show();g.pagination.currentActivePage=1;g.pagination.update()};a(e+" > "+k).attr(j,"true");g.pagination.update()};var c=new d(b.container,b.repeater,b.valueselectors,b.paginationOptions);if(b.defaultListDisplay){c.showAList()}else{c.hideAList()}a(a.find(b.searchbox)).on("keyup",function(){var e=a(this).val().toLowerCase().replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c.searchAList(e,b.container,b.repeater,b.valueselectors)});if(b.sortOptions!=null){a(b.sortOptions).each(function(){a(this.selector).attr("jQAlist-sort",this.sortSelector);a(this.selector).on(this.event,function(){if(a(this).attr("jQAlist-sorted")=="asc"){a(this).attr("jQAlist-sorted","dsc")}else{a(this).attr("jQAlist-sorted","asc")}c.sortAList(a(this).attr("jQAlist-sort"),a(this).attr("jQAlist-sorted"))})})}return{api:c,options:b}}})(jQuery);